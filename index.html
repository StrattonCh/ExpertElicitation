<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Statistical methods for incoporating expert elicitation in occupancy modeling frameworks</title>

  <meta property="description" itemprop="description" content="A simulation study in implementation of hierarchical models to accommodate expert elicitation with bat occupancy data"/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-11-04"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-11-04"/>
  <meta name="article:author" content="Christian Stratton"/>
  <meta name="article:author" content="Kathryn Irvine"/>
  <meta name="article:author" content="Brad Udell"/>
  <meta name="article:author" content="Brian Reichert"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Statistical methods for incoporating expert elicitation in occupancy modeling frameworks"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="A simulation study in implementation of hierarchical models to accommodate expert elicitation with bat occupancy data"/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Statistical methods for incoporating expert elicitation in occupancy modeling frameworks"/>
  <meta property="twitter:description" content="A simulation study in implementation of hierarchical models to accommodate expert elicitation with bat occupancy data"/>

  <!--/radix_placeholder_meta_tags-->
  
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","bibliography","csl"]}},"value":[{"type":"character","attributes":{},"value":["Statistical methods for incoporating expert elicitation in occupancy modeling frameworks"]},{"type":"character","attributes":{},"value":["A simulation study in implementation of hierarchical models to accommodate expert elicitation with bat occupancy data\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Christian Stratton"]},{"type":"character","attributes":{},"value":["Montana State University"]},{"type":"character","attributes":{},"value":["https://math.montana.edu/"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Kathryn Irvine"]},{"type":"character","attributes":{},"value":["USGS Northern Rocky Mountain Science Center"]},{"type":"character","attributes":{},"value":["https://www.usgs.gov/centers/norock"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Brad Udell"]},{"type":"character","attributes":{},"value":["USGS Fort Collins Science Center"]},{"type":"character","attributes":{},"value":["https://www.usgs.gov/centers/fort-collins-science-center"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation","affiliation_url"]}},"value":[{"type":"character","attributes":{},"value":["Brian Reichert"]},{"type":"character","attributes":{},"value":["USGS Fort Collins Science Center"]},{"type":"character","attributes":{},"value":["https://www.usgs.gov/centers/fort-collins-science-center"]}]}]},{"type":"character","attributes":{},"value":["2022-11-04"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]}]}]},{"type":"character","attributes":{},"value":["bibliography.bib"]},{"type":"character","attributes":{},"value":["biometrics_notes.csl"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["bibliography.bib","biometrics_notes.csl","index_files/anchor-4.2.2/anchor.min.js","index_files/bowser-1.9.3/bowser.min.js","index_files/distill-2.2.21/template.v2.js","index_files/figure-html5/unnamed-chunk-10-1.png","index_files/figure-html5/unnamed-chunk-10-2.png","index_files/figure-html5/unnamed-chunk-11-1.png","index_files/figure-html5/unnamed-chunk-11-2.png","index_files/figure-html5/unnamed-chunk-12-1.png","index_files/figure-html5/unnamed-chunk-12-2.png","index_files/figure-html5/unnamed-chunk-12-3.png","index_files/figure-html5/unnamed-chunk-16-1.png","index_files/figure-html5/unnamed-chunk-16-2.png","index_files/figure-html5/unnamed-chunk-2-1.png","index_files/figure-html5/unnamed-chunk-3-1.png","index_files/figure-html5/unnamed-chunk-5-1.png","index_files/figure-html5/unnamed-chunk-5-2.png","index_files/figure-html5/unnamed-chunk-6-1.png","index_files/figure-html5/unnamed-chunk-6-2.png","index_files/figure-html5/unnamed-chunk-7-1.png","index_files/figure-html5/unnamed-chunk-7-2.png","index_files/figure-html5/unnamed-chunk-8-1.png","index_files/figure-html5/unnamed-chunk-8-2.png","index_files/header-attrs-2.14/header-attrs.js","index_files/jquery-3.6.0/jquery-3.6.0.js","index_files/jquery-3.6.0/jquery-3.6.0.min.js","index_files/jquery-3.6.0/jquery-3.6.0.min.map","index_files/popper-2.6.0/popper.min.js","index_files/tippy-6.2.7/tippy-bundle.umd.min.js","index_files/tippy-6.2.7/tippy-light-border.css","index_files/tippy-6.2.7/tippy.css","index_files/tippy-6.2.7/tippy.umd.min.js","index_files/webcomponents-2.0.0/webcomponents.js","julia code/idyllic/data_list.rds","julia code/idyllic/expert_hier_idyllic.rds","julia code/idyllic/fit_occ.jl","julia code/idyllic/model0.rds","julia code/idyllic/model1.rds","julia code/idyllic/occ_idyllic.rds","julia code/idyllic/stan_fit.rds","julia code/idyllic/stan_fit_normal.rds","julia code/idyllic/stan_normal.rds","julia code/idyllic/stan_normal.stan","julia code/idyllic/stan_occ.rds","julia code/idyllic/stan_occ.stan","julia code/missingcovs/data_list.rds","julia code/missingcovs/fit_occ.jl","julia code/missingcovs/model0.rds","julia code/missingcovs/model1.rds"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
          var fn = $(this).children()[0]
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="index_files/header-attrs-2.14/header-attrs.js"></script>
  <script src="index_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="index_files/popper-2.6.0/popper.min.js"></script>
  <link href="index_files/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="index_files/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="index_files/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="index_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="index_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="index_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="index_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Statistical methods for incoporating expert elicitation in occupancy modeling frameworks","description":"A simulation study in implementation of hierarchical models to accommodate expert elicitation with bat occupancy data","authors":[{"author":"Christian Stratton","authorURL":"#","affiliation":"Montana State University","affiliationURL":"https://math.montana.edu/","orcidID":""},{"author":"Kathryn Irvine","authorURL":"#","affiliation":"USGS Northern Rocky Mountain Science Center","affiliationURL":"https://www.usgs.gov/centers/norock","orcidID":""},{"author":"Brad Udell","authorURL":"#","affiliation":"USGS Fort Collins Science Center","affiliationURL":"https://www.usgs.gov/centers/fort-collins-science-center","orcidID":""},{"author":"Brian Reichert","authorURL":"#","affiliation":"USGS Fort Collins Science Center","affiliationURL":"https://www.usgs.gov/centers/fort-collins-science-center","orcidID":""}],"publishedDate":"2022-11-04T00:00:00.000-06:00","citationText":"Stratton, et al., 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Statistical methods for incoporating expert elicitation in occupancy modeling frameworks</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>A simulation study in implementation of hierarchical models to
accommodate expert elicitation with bat occupancy data</p></p>
</div>

<div class="d-byline">
  Christian Stratton  (Montana State University)<a
href="https://math.montana.edu/"
class="uri">https://math.montana.edu/</a>
  
,   Kathryn Irvine  (USGS Northern Rocky Mountain Science Center)<a
href="https://www.usgs.gov/centers/norock"
class="uri">https://www.usgs.gov/centers/norock</a>
  
,   Brad Udell  (USGS Fort Collins Science Center)<a
href="https://www.usgs.gov/centers/fort-collins-science-center"
class="uri">https://www.usgs.gov/centers/fort-collins-science-center</a>
  
,   Brian Reichert  (USGS Fort Collins Science Center)<a
href="https://www.usgs.gov/centers/fort-collins-science-center"
class="uri">https://www.usgs.gov/centers/fort-collins-science-center</a>
  
<br/>2022-11-04
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction" id="toc-introduction">Introduction</a></li>
<li><a href="#model-framework" id="toc-model-framework">Model
framework</a>
<ul>
<li><a href="#base-site-occupancy-modeling-framework"
id="toc-base-site-occupancy-modeling-framework">Base site-occupancy
modeling framework</a></li>
<li><a href="#addition-of-random-effects"
id="toc-addition-of-random-effects">Addition of random effects</a></li>
</ul></li>
<li><a href="#expert-response-structure"
id="toc-expert-response-structure">Expert response structure</a>
<ul>
<li><a href="#daubenmire-classes" id="toc-daubenmire-classes">Daubenmire
classes</a></li>
<li><a href="#normal-k-root-mean-weighted-mapping"
id="toc-normal-k-root-mean-weighted-mapping">Normal k-root-mean-weighted
mapping</a></li>
</ul></li>
<li><a href="#model-estimation" id="toc-model-estimation">Model
estimation</a>
<ul>
<li><a href="#polya-gamma-data-augmentation"
id="toc-polya-gamma-data-augmentation">Polya-gamma data
augmentation</a></li>
<li><a href="#sampling-boldsymbolzpsi"
id="toc-sampling-boldsymbolzpsi">Sampling <span
class="math inline">\(\boldsymbol{z}^{(\psi)}\)</span></a></li>
<li><a href="#sampling-boldsymbolomegabeta"
id="toc-sampling-boldsymbolomegabeta">Sampling <span
class="math inline">\(\boldsymbol{\omega}^{(\beta)}\)</span></a></li>
<li><a href="#sampling-boldsymbolbeta"
id="toc-sampling-boldsymbolbeta">Sampling <span
class="math inline">\(\boldsymbol{\beta}\)</span></a></li>
<li><a href="#sampling-boldsymboltheta"
id="toc-sampling-boldsymboltheta">Sampling <span
class="math inline">\(\boldsymbol{\theta}\)</span></a></li>
<li><a href="#sampling-boldsymbolmu"
id="toc-sampling-boldsymbolmu">Sampling <span
class="math inline">\(\boldsymbol{\mu}\)</span></a></li>
<li><a href="#sampling-tau" id="toc-sampling-tau">Sampling <span
class="math inline">\(\tau\)</span></a></li>
</ul></li>
<li><a href="#synthetic-data-scenarios"
id="toc-synthetic-data-scenarios">Synthetic data scenarios</a>
<ul>
<li><a href="#idyllic-case" id="toc-idyllic-case">Idyllic case</a></li>
<li><a href="#missing-covariate-information"
id="toc-missing-covariate-information">Missing covariate
information</a></li>
</ul></li>
<li><a href="#appendix-models-in-stan"
id="toc-appendix-models-in-stan">Appendix: Models in Stan</a></li>
</ul>
</nav>
</div>
<h1 id="introduction">Introduction</h1>
<h1 id="model-framework">Model framework</h1>
<h2 id="base-site-occupancy-modeling-framework">Base site-occupancy
modeling framework</h2>
<p>For now, we layer this framework on a standard occupancy model. Let
<span class="math inline">\(i\)</span> index the location, <span
class="math inline">\(j\)</span> index the visit to site <span
class="math inline">\(i\)</span>, and <span
class="math inline">\(Z_i\)</span> denote the partially observed
occupancy states of sites <span class="math inline">\(1, \dots,
n\)</span>. Then, <span class="math display">\[
\begin{split}
Z_i &amp;\sim \text{Bernoulli}(\psi_i) \\
y_i &amp;\sim \text{Bernoulli}(z_i p_{ij})
\end{split}
\]</span> where <span class="math inline">\(\text{logit}(\psi_i) =
x_i&#39;\beta\)</span> and <span
class="math inline">\(\text{logit}(p_{ij}) = W\alpha\)</span>.</p>
<h2 id="addition-of-random-effects">Addition of random effects</h2>
<p>To accommodate extra sources of variation not captured by <span
class="math inline">\(X\)</span>, we include spatially indexed random
effects for each site. <span class="math display">\[
\begin{split}
Z_i &amp;\sim \text{Bernoulli}(\psi_i) \\
y_i &amp;\sim \text{Bernoulli}(z_i p_{ij})
\end{split}
\]</span> where <span class="math inline">\(\text{logit}(\psi_i) =
x_i&#39;\beta + \theta_{i}\)</span> and <span
class="math inline">\(\text{logit}(p_{ij}) = W\alpha\)</span>.</p>
<p>Additional structure may be imposed on <span
class="math inline">\(\boldsymbol{\theta}\)</span>. For example, one
could draw <span class="math inline">\(\boldsymbol{\theta}\)</span> from
a Gaussian process with spatial covariance structure. Alternatively,
<span class="math inline">\(\boldsymbol{\theta}\)</span> may be drawn
from a hierarchical normal distribution if expert information is
available to inform a grouping structure among sites. <span
class="math display">\[
\boldsymbol{\theta} \sim \mathcal{N}(\boldsymbol{\mu}, \boldsymbol{\tau}
\boldsymbol{\Omega}\boldsymbol{\tau}^T)
\]</span> Under this formulation, <span
class="math inline">\(\text{logit}(\psi_i) = x_i&#39;\beta +
\theta_{c_i}\)</span>, where <span
class="math inline">\(\boldsymbol{c}\)</span> is a vector of indicators
denoting the group associated with <span
class="math inline">\(\psi_i\)</span>. Note that the above formulation
assume a general correlation structure among <span
class="math inline">\(\boldsymbol{\theta}\)</span> (in the form of <span
class="math inline">\(\boldsymbol{\Omega}\)</span>), but independence
may be assumed. Under this framework, expert knowledge may be used to
inform <span class="math inline">\(\boldsymbol{\mu}\)</span>. For
example, <span class="math display">\[
\boldsymbol{\mu} \sim \mathcal{N}(\boldsymbol{m},
\boldsymbol{s}\mathcal{I}\boldsymbol{s}^T)
\]</span></p>
<h1 id="expert-response-structure">Expert response structure</h1>
<p>The goal is to collect information from experts in a way that can
easily inform the prior distributions for the spatial random effects.
One option is to solicit feedback directly on the occupancy
probabilities, then map those probabilities to the real line.</p>
<h2 id="daubenmire-classes">Daubenmire classes</h2>
<p>To aid in describing the uncertainties in this mapping, one could use
the Daubenmire coverage class <span class="citation"
data-cites="daubenmire1959">(<a href="#ref-daubenmire1959"
role="doc-biblioref">Daubenmire, 1959</a>)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Table 1: Daubenmire coverage classes
(Daubenmire, 1959).</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Class</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
<th style="text-align: right;">Midpoint</th>
<th style="text-align: right;">logitL</th>
<th style="text-align: right;">logitM</th>
<th style="text-align: right;">logitU</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">-4.60</td>
<td style="text-align: right;">-3.66</td>
<td style="text-align: right;">-3.18</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">-2.75</td>
<td style="text-align: right;">-1.73</td>
<td style="text-align: right;">-1.15</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">-1.05</td>
<td style="text-align: right;">-0.51</td>
<td style="text-align: right;">-0.04</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">1.05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">1.73</td>
<td style="text-align: right;">2.75</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.95</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">3.18</td>
<td style="text-align: right;">3.66</td>
<td style="text-align: right;">4.60</td>
</tr>
</tbody>
</table>
</div>
<h2 id="normal-k-root-mean-weighted-mapping">Normal k-root-mean-weighted
mapping</h2>
<p>There are many potential mappings for expert feedback in the form of
Daubenmire classes. Generally, the mapping should imply lesser
probability of occurrence for lower classes. Additionally, it may be
reasonable to imply greater certainty in large classes
(i.e. probabilities close to 0 and 1 are more certain than those close
to 0). Finally, it is computationally attractive to restrict mappings to
the Normal family of distributions (though this can be relaxed). A
mapping that satisfies these requirements is described below.</p>
<p>Let <span class="math inline">\(l_i, u_i\)</span>, and <span
class="math inline">\(\mu_i\)</span> denote the implied lower, upper,
and midpoints of each class on the logit scale. Then the normal
mean-weighted mapping proceeds as follows. For each class <span
class="math inline">\(i\)</span> and any positive real <span
class="math inline">\(k\)</span>, find <span
class="math inline">\(\sigma_i\)</span> such that <span
class="math display">\[
\int_{l_i}^{u_i} p\left(y \big| \mu_i,\frac{1}{|\mu_i|^k}
\sigma_i\right) dy = .95
\]</span> where <span class="math inline">\(p(y | \mu, \sigma)\)</span>
is the density function for a normal random variate with mean <span
class="math inline">\(\mu\)</span> and standard deviation <span
class="math inline">\(\sigma\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="index_files/figure-html5/unnamed-chunk-2-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<h1 id="model-estimation">Model estimation</h1>
<p>To improve computational efficiency, we write the sampler for this
model by hand. Leveraging the data augmentation strategy of <span
class="citation" data-cites="polson2013">Polson, Scott and Windle (<a
href="#ref-polson2013" role="doc-biblioref">2013</a>)</span>, Gibbs
draws are available for all parameters in the model. The full
specification of the model is as follows. Let <span
class="math inline">\(i\)</span> index the sample location, <span
class="math inline">\(j\)</span> index the visit to site <span
class="math inline">\(i\)</span>, and <span
class="math inline">\(\boldsymbol{c}\)</span> denote a vector group
membership informed by expert opinion. Then, <span
class="math display">\[
\begin{split}
Z_i &amp;\sim \text{Bernoulli}(\psi_i) \\
y_{ij} &amp;\sim \text{Bernoulli}(z_i p_{ij})
\end{split}
\]</span> where <span class="math inline">\(\text{logit}(\psi_i) =
\boldsymbol{x}_i^T\boldsymbol{\beta}+ \theta_{c_i}\)</span> and <span
class="math display">\[
\boldsymbol{\theta} \sim \mathcal{N}(\boldsymbol{\mu}, \tau^2
\boldsymbol{\mathcal{I}})
\]</span> For now, we assume that <span class="math inline">\(p_{ij} =
p\)</span> for all <span class="math inline">\(\{i, j\}\)</span> to
speed up computation (though this assumption can be easily relaxed).</p>
<h2 id="polya-gamma-data-augmentation">Polya-gamma data
augmentation</h2>
<p>For binomial and negative binomial sampling models, we implement the
Polya-gamma data augmentation strategy of <span class="citation"
data-cites="polson2013">Polson et al. (<a href="#ref-polson2013"
role="doc-biblioref">2013</a>)</span>. This strategy introduces
auxiliary Polya-gamma distributed random variables to each likelihood to
afford conditionally Gaussian posterior distributions, allowing for
Gibbs draws of regression coefficients. This data augmentation is
relevant for sampling <span class="math inline">\(\alpha,
\beta\)</span>, and <span class="math inline">\(\eta\)</span>.</p>
<h2 id="sampling-boldsymbolzpsi">Sampling <span
class="math inline">\(\boldsymbol{z}^{(\psi)}\)</span></h2>
<p>We let <span class="math inline">\(\boldsymbol{z}^{(\psi)}\)</span>
denote the vector of partially observed occupancy states and <span
class="math inline">\(y_{ij}\)</span> denote the observed response
during visit <span class="math inline">\(j\)</span> to site <span
class="math inline">\(i\)</span>. From <span class="citation"
data-cites="dorazio2018">Dorazio and Erickson (<a
href="#ref-dorazio2018" role="doc-biblioref">2018</a>)</span>, the full
conditional distribution of <span
class="math inline">\(\boldsymbol{z}^{(\psi)}\)</span> is, <span
class="math display">\[
Z_i^{(\psi)} \sim
\begin{cases}
\text{Bernoulli}(1) &amp; \text{if} \sum_{j=1}^{J_i} y_{ij} &gt; 0 \\
\text{Bernoulli}\left(\frac{\psi_i\prod_{j=1}^{J_i} (1 - p_{ij})}{1
-\psi_i + \psi_i\prod_{j=1}^{J_i} (1 - p_{ij})}\right) &amp; \text{if}
\sum_{j=1}^{J_i} y_{ij} = 0
\end{cases}
\]</span></p>
<h2 id="sampling-boldsymbolomegabeta">Sampling <span
class="math inline">\(\boldsymbol{\omega}^{(\beta)}\)</span></h2>
<p>Let <span class="math inline">\(\omega^{(\beta)}_i \sim \text{PG}(1,
0)\)</span>. Then, <span class="math display">\[
z_i = \frac{1}{\omega^{(\beta)}_i}\left(z^{(\psi)}_i -
\frac{1}{2}\right) \sim
\mathcal{N}\left(\boldsymbol{x}_i&#39;\boldsymbol{\beta} + \theta_{c_i},
\frac{1}{\omega_i} \right).
\]</span> where <span class="math inline">\(z^{(\psi)}_i\)</span> is the
latent occupancy state for site <span class="math inline">\(i\)</span>.
See <span class="citation" data-cites="polson2013">Polson et al. (<a
href="#ref-polson2013" role="doc-biblioref">2013</a>)</span> for more
detail. Equivalently, let <span
class="math inline">\(\boldsymbol{\Omega}_{(\beta)} =
\text{diag}(\omega^{(\beta)}_1, \dots, \omega^{(\beta)}_n)\)</span>.
Then, <span class="math display">\[
\boldsymbol{z} \sim \mathcal{N}\left(X\boldsymbol{\beta}+
\boldsymbol{C}\boldsymbol{\theta},
\boldsymbol{\Omega}_{(\beta)}^{-1}\right)
\]</span> where <span class="math inline">\(\boldsymbol{C}\)</span> is
an indicator matrix denoting group membership. From <span
class="citation" data-cites="polson2013">Polson et al. (<a
href="#ref-polson2013" role="doc-biblioref">2013</a>)</span>, the full
conditional distribution of <span
class="math inline">\(\omega^{(\beta)}_i\)</span> is <span
class="math display">\[
\begin{split}
\omega^{(\beta)}_i | \cdot \sim \text{PG}(1,
\boldsymbol{x}_i&#39;\boldsymbol{\beta} + \theta_{c_i})
\end{split}
\]</span></p>
<h2 id="sampling-boldsymbolbeta">Sampling <span
class="math inline">\(\boldsymbol{\beta}\)</span></h2>
<p>Let <span class="math inline">\(\boldsymbol{\beta} \sim
\mathcal{N}(\boldsymbol{\mu}_{0, \beta}, \boldsymbol{\Sigma}_{0,
\beta})\)</span>.Then, <span class="math display">\[
\begin{split}
\boldsymbol{\beta} | \cdot &amp;\sim \mathcal{N}(\boldsymbol{m},
\boldsymbol{V}) \\
\boldsymbol{V} &amp;= \left(\boldsymbol{X}^T
\boldsymbol{\Omega}_{(\beta)} \boldsymbol{X}
+  \boldsymbol{\Sigma}^{-1}_{0, \beta}\right)^{-1} \\
\boldsymbol{m} &amp;= \boldsymbol{V} \left(\boldsymbol{X}^T
\boldsymbol{\Omega}_{(\beta)} (\boldsymbol{z} -
\boldsymbol{C}\boldsymbol{\theta}) + \boldsymbol{\Sigma}^{-1}_{0,
\beta}\boldsymbol{\mu}_{0, \beta} \right)
\end{split}
\]</span></p>
<p>Proof (omitting boldface text):</p>
<p>Let <span class="math inline">\(z^* = z - C\theta\)</span> <span
class="math display">\[
\begin{split}
p(\beta | z^*, \omega^{(\beta)}) &amp;\propto p(z^* | \beta,
\omega^{(\beta)}) p(\beta) \\
&amp;\propto \exp\left\{-\frac{1}{2}(z^* - X\beta)^T
\Omega_{(\beta)}(z^* - X\beta) \right\} \exp\left\{-\frac{1}{2}(\beta -
\mu_{0, \beta})^T \Sigma^{-1}_{(0,\beta)}(\beta - \mu_{0, \beta})
\right\}  \\
&amp;\propto \exp \left\{-\frac{1}{2} \left(\beta^T (X^T
\Omega_{(\beta)} X + \Sigma^{-1}_{0, \beta})  \beta - 2\beta^T( X^T
\Omega_{(\beta)} z^* + \Sigma^{-1}_{0, \beta}\mu_{0, \beta} )\right)
\right\}
\end{split}
\]</span></p>
<h2 id="sampling-boldsymboltheta">Sampling <span
class="math inline">\(\boldsymbol{\theta}\)</span></h2>
<p>Let <span class="math inline">\(\boldsymbol{\theta} \sim
\mathcal{N}(\boldsymbol{\mu}, \tau^2\boldsymbol{\mathcal{I}})\)</span>.
Note that the expert elicitation informs <span
class="math inline">\(\boldsymbol{\mu}\)</span>. The full conditional
posterior distribution of <span
class="math inline">\(\boldsymbol{\theta}\)</span> is <span
class="math display">\[
\begin{split}
\boldsymbol{\theta} | \cdot &amp;\sim \mathcal{N}(\boldsymbol{m},
\boldsymbol{V}) \\
\boldsymbol{V} &amp;= \left(\boldsymbol{C}^T
\boldsymbol{\Omega}_{(\beta)} \boldsymbol{C}
+  \frac{1}{\tau^2}\boldsymbol{\mathcal{I}}\right)^{-1} \\
\boldsymbol{m} &amp;= \boldsymbol{V} \left(\boldsymbol{C}^T
\boldsymbol{\Omega}_{(\beta)} (\boldsymbol{z} -
\boldsymbol{X}\boldsymbol{\beta}) + \frac{1}{\tau^2}
\boldsymbol{\mathcal{I}}\boldsymbol{\mu} \right)
\end{split}
\]</span></p>
<p>Proof (omitting boldface text):</p>
<p>Let <span class="math inline">\(z^* = z - X\beta\)</span> <span
class="math display">\[
\begin{split}
p(\beta | z^*, \omega^{(\beta)}) &amp;\propto p(z^* | \theta,
\omega^{(\beta)}) p(\theta) \\
&amp;\propto \exp\left\{-\frac{1}{2}(z^* - C\theta)^T
\Omega_{(\beta)}(z^* - C\theta) \right\} \exp\left\{-\frac{1}{2}(\theta
- \mu)^T \frac{1}{\tau^2}\mathcal{I}(\theta - \mu) \right\}  \\
&amp;\propto \exp \left\{-\frac{1}{2} \left(\theta^T (C^T
\Omega_{(\beta)} C + \frac{1}{\tau^2}\mathcal{I})  \theta - 2\theta^T(
C^T \Omega_{(\beta)} z^* + \frac{1}{\tau^2} \mathcal{I}\mu )\right)
\right\}
\end{split}
\]</span></p>
<h2 id="sampling-boldsymbolmu">Sampling <span
class="math inline">\(\boldsymbol{\mu}\)</span></h2>
<p>Let <span class="math inline">\(\boldsymbol{\mu} \sim
\mathcal{N}(\boldsymbol{m},
\boldsymbol{s}\mathcal{I}\boldsymbol{s}^T)\)</span>, where <span
class="math inline">\(\boldsymbol{m}\)</span> and <span
class="math inline">\(\boldsymbol{s}\)</span> may be informed by expert
opinion. Then <span class="math display">\[
\begin{split}
\boldsymbol{\mu} | \cdot &amp;\sim \mathcal{N}(\boldsymbol{m}_0,
\boldsymbol{V})  \\
\boldsymbol{V} &amp;= \left(\frac{1}{\tau^2} \boldsymbol{\mathcal{I}} +
\boldsymbol{s}^{-1}\boldsymbol{\mathcal{I}} (\boldsymbol{s}^{-1})^T
\right)^{-1} \\
\boldsymbol{m}_0 &amp;= \boldsymbol{V}\left(\frac{1}{\tau^2}
\boldsymbol{\mathcal{I}}\boldsymbol{\theta} +
\boldsymbol{s}^{-1}\boldsymbol{\mathcal{I}} (\boldsymbol{s}^{-1})^T
\boldsymbol{m} \right)
\end{split}
\]</span></p>
<p>Proof (omitting boldface text): <span class="math display">\[
\begin{split}
p(\mu | \cdot) &amp;\propto p(\theta | \mu, \tau^2) p(\mu) \\
&amp;\propto \exp\left\{-\frac{1}{2}(\theta - \mu)^T
\frac{1}{\tau^2}\mathcal{I}(\theta - \mu) \right\}
\exp\left\{-\frac{1}{2}(\mu - m)^T s^{-1} \mathcal{I} s^{-1} (\mu - m)
\right\} \\
&amp;\propto \exp\left\{ -\frac{1}{2} \left(\mu^T (\frac{1}{\tau^2}
\mathcal{I} + s^{-1} \mathcal{I} s^{-1})\mu -
2\mu^T(\frac{1}{\tau^2}\mathcal{I}\theta + s^{-1} \mathcal{I} s^{-1} m)
\right) \right\}
\end{split}
\]</span></p>
<h2 id="sampling-tau">Sampling <span
class="math inline">\(\tau\)</span></h2>
<p>Let <span class="math inline">\(\tau^2 \sim \text{Inverse-Gamma}(a_0,
b_0)\)</span>. Then, <span class="math display">\[
\begin{split}
\tau^2 | \cdot &amp;\sim \text{Inverse-Gamma}(a, b) \\
a &amp;= a_0 + \frac{K}{2} \\
b &amp;= b_0 + \frac{1}{2}(\boldsymbol{\theta} -
\boldsymbol{\mu})^T(\boldsymbol{\theta} - \boldsymbol{\mu})
\end{split}
\]</span></p>
<p>Proof (omitting boldface): <span class="math display">\[
\begin{split}
p(\tau^2 | \theta, \mu) &amp;\propto p(\theta | \tau^2, \mu) p(\tau^2)
\\
&amp;\propto (\tau^2)^{-K/2} \exp\left\{-\frac{1}{2}(\theta - \mu)^T
\frac{1}{\tau^2} \mathcal{I}(\theta - \mu)\right\} (\tau^2)^{-a_0 - 1}
\exp\left(-\frac{b_0}{\tau^2}\right)
\end{split}
\]</span></p>
<h1 id="synthetic-data-scenarios">Synthetic data scenarios</h1>
<h2 id="idyllic-case">Idyllic case</h2>
<p>In the ideal case, species occupancy arises as a function of some
linear relationship with covariates and a regional intercept that is not
directly observed. The experts then inform this regional intercept.</p>
<h3 id="sampling-model">Sampling model</h3>
<p>We first imagine the data arising directly from the specified model.
That is, <span class="math display">\[
\begin{split}
Z_i &amp;\sim \text{Bernoulli}(\psi_i) \\
y_i &amp;\sim \text{Bernoulli}(z_i p_{ij})
\end{split}
\]</span> where <span class="math inline">\(\text{logit}(\psi_i) =
x_i&#39;\beta + \theta_{c_i}\)</span> and <span
class="math inline">\(\text{logit}(p_{ij}) = W\alpha\)</span>.
Furthermore, we assume that <span class="math inline">\(\theta_{c_i}
\sim N(\mu_{c_i}, \tau^2)\)</span>, where <span
class="math inline">\(c_i\)</span> is an indicator vector denoting
distinct regions assigned by the expert. For now, we assume that <span
class="math inline">\(p\)</span> is constant (to speed up simulated
studies).</p>
<h3 id="simulated-data">Simulated data</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="index_files/figure-html5/unnamed-chunk-3-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<h3 id="fit-models-with-julia">Fit models with Julia</h3>
<p>We consider two potential models:</p>
<ul>
<li>model0: basic occupancy model without region-specific random
effects</li>
<li>model1: occupancy model with region-specific random effects informed
by experts</li>
</ul>
<p>For the time being, we assume the experts are correct.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="model0">model0</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>              Mean       2.5%       97.5%      Rhat ess_bulk
p        0.5110552  0.4859887 0.535767859 0.9998710 7525.722
beta[1] -0.2250412 -0.4475441 0.000428128 0.9999461 7340.170
beta[2]  0.9821882  0.7578709 1.222570171 0.9999311 5695.660
psi[1]   0.2394866  0.1806286 0.301809415 0.9999085 6532.857
psi[2]   0.2186129  0.1604826 0.281211272 0.9998611 6441.005
psi[3]   0.1893535  0.1331817 0.251433860 0.9998586 6320.579
psi[4]   0.3322566  0.2742926 0.391719809 0.9998836 7002.069
psi[5]   0.3056476  0.2466830 0.366100585 0.9998817 6877.817
psi[6]   0.5791978  0.5213224 0.639238212 1.0002640 6805.114
psi[7]   0.4558142  0.4017611 0.511929093 0.9999572 7330.942
psi[8]   0.6379023  0.5759368 0.701713565 1.0003803 6482.564</code></pre>
<p><img src="index_files/figure-html5/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;" /><img src="index_files/figure-html5/unnamed-chunk-5-2.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<h4 id="model1">model1</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>                Mean       2.5%      97.5%     Rhat  ess_bulk
p         0.51108481  0.4862074  0.5360973 1.000194 7372.1701
tau       1.26274914  0.6237233  2.4692426 1.003479 1361.7690
beta[1]  -0.49798292 -1.6616684  0.5515058 1.011493  404.4277
beta[2]   0.97757341  0.6712944  1.3127635 1.000494 3419.8080
theta[1] -4.60452243 -7.2279204 -2.7408798 1.005345  902.1900
theta[2] -0.07509478 -1.2112969  1.2282788 1.007554  480.3740
theta[3] -0.45732525 -1.5981580  0.7808603 1.006037  470.4869
theta[4]  0.78886163 -0.3966938  2.0502357 1.006807  487.3187
theta[5]  2.71026218  1.4220508  4.2555043 1.002956  658.9189
theta[6]  2.63972246  1.3933441  3.9265448 1.003605  618.0339
theta[7] -1.93068826 -3.6950165 -0.3259983 1.001281 1044.2672</code></pre>
<p><img src="index_files/figure-html5/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;" /><img src="index_files/figure-html5/unnamed-chunk-6-2.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<h4 id="compare">Compare</h4>
<div class="layout-chunk" data-layout="l-body">
<p><img src="index_files/figure-html5/unnamed-chunk-7-1.png" width="960" style="display: block; margin: auto;" /><img src="index_files/figure-html5/unnamed-chunk-7-2.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<h2 id="missing-covariate-information">Missing covariate
information</h2>
<p>Another way to imagine the data generating mechanism is as a
consequence of missing covariate information. Suppose that the true data
generating model is <span class="math display">\[
\begin{split}
Z_i &amp;\sim \text{Bernoulli}(\psi_i) \\
y_i &amp;\sim \text{Bernoulli}(z_i p_{ij})
\end{split}
\]</span> where <span class="math inline">\(\text{logit}(\psi_i) =
\beta0 + x_{1,i}&#39;\beta_1 + x_{2,i}&#39;\beta_2\)</span>. Further
suppose that we only directly observe <span
class="math inline">\(x_1\)</span>. In this case, the role of the
experts is to adjust our mispecified model by informing hyper-priors on
random effects that can be used as a surrogate for the missing
covariance information. During data generation, this is achieved by
thresholding the true probability surface to match the Daubenmire
classes.</p>
<h3 id="simulated-data-1">Simulated data</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="index_files/figure-html5/unnamed-chunk-8-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<h3 id="fit-models-with-julia-1">Fit models with Julia</h3>
<p>We consider two potential models:</p>
<ul>
<li>model0: basic occupancy model without region-specific random
effects</li>
<li>model1: occupancy model with region-specific random effects informed
by experts</li>
</ul>
<p>For the time being, we assume the experts are correct.</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<h4 id="model0-1">model0</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>              Mean       2.5%      97.5%      Rhat ess_bulk
p        0.5004493  0.4745246  0.5253616 1.0000740 7613.910
beta[1]  0.5035283  0.2508224  0.7590192 0.9998814 6910.613
beta[2] -0.9617888 -1.2054501 -0.7304798 1.0007261 5893.471
psi[1]   0.6283971  0.5674139  0.6871099 0.9998889 6906.563
psi[2]   0.5027038  0.4483388  0.5564906 0.9998083 6842.481
psi[3]   0.3641491  0.3056988  0.4229021 1.0008043 6287.028
psi[4]   0.5544383  0.4980193  0.6090761 0.9998260 6945.503
psi[5]   0.4869237  0.4328967  0.5407919 0.9998072 6794.286
psi[6]   0.4912591  0.4371543  0.5450432 0.9998057 6807.877
psi[7]   0.4554299  0.4013616  0.5099638 0.9998159 6521.480
psi[8]   0.5079869  0.4534887  0.5617067 0.9998074 6862.377</code></pre>
<p><img src="index_files/figure-html5/unnamed-chunk-10-1.png" width="960" style="display: block; margin: auto;" /><img src="index_files/figure-html5/unnamed-chunk-10-2.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<h4 id="model1-1">model1</h4>
<div class="layout-chunk" data-layout="l-body">
<pre><code>                Mean         2.5%       97.5%     Rhat  ess_bulk
p         0.50063780  0.475242693  0.52647355 1.000084 7288.9061
tau       0.81656074  0.428287405  1.67859888 1.001071 2447.6461
beta[1]   0.09986724 -0.764794259  0.99152233 1.005434  487.2515
beta[2]  -0.12918745 -0.448384129  0.18349802 1.002019 3900.7013
theta[1] -4.01206799 -5.825694904 -2.58734725 1.001361 2361.6896
theta[2] -1.68721879 -2.717810619 -0.68258461 1.005888  536.3006
theta[3] -0.27305739 -1.183951766  0.67654796 1.005134  530.0008
theta[4]  0.44696410 -0.502108407  1.36346136 1.004521  538.8751
theta[5]  1.89197815  0.895924091  2.92623146 1.004430  678.3002
psi[1]    0.17629180  0.090133250  0.29198403 1.001163 3973.1363
psi[2]    0.02480570  0.002571172  0.07614703 1.001919 1982.2740</code></pre>
<p><img src="index_files/figure-html5/unnamed-chunk-11-1.png" width="960" style="display: block; margin: auto;" /><img src="index_files/figure-html5/unnamed-chunk-11-2.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<h4 id="compare-1">Compare</h4>
<div class="layout-chunk" data-layout="l-body">
<p><img src="index_files/figure-html5/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;" /><img src="index_files/figure-html5/unnamed-chunk-12-2.png" width="960" style="display: block; margin: auto;" /><img src="index_files/figure-html5/unnamed-chunk-12-3.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<h1 id="appendix-models-in-stan">Appendix: Models in Stan</h1>
<p>Below we provide <code>stan</code> code to fit the above model and
showcase it on the data from the idyllic scenario. This model takes
approximately 30 seconds to draw 5000 posterior samples (opposed to ~ 3
seconds for the Julia version).</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>S4 class stanmodel &#39;anon_model&#39; coded as follows:
// consider https://mc-stan.org/docs/stan-users-guide/multivariate-hierarchical-priors.html
// for more complexity and dependence among theta
data {
  int&lt;lower=1&gt; N; // Number of sites
  int&lt;lower=1&gt; J; // Number of visits (fixed for now, doesnt have to be)
  int&lt;lower = 1&gt; K; // Number of categories
  int&lt;lower=0, upper=K&gt; group[N];  // Indicator vector
  int&lt;lower=0&gt; sumy[N]; // Sum of obs for all visits
  real x[N];
  real m[K]; // prior means from mapping the experts
  real&lt;lower = 0&gt; s[K]; // prior sds from mapping the experts
}
parameters {
  real beta0;
  real beta1;
  real theta[K];
  real mu[K];
  real&lt;lower=0, upper=1&gt; p; // Detection probability
  real&lt;lower=0&gt; tau;
}
model {
  // hyper priors
  for(k in 1:K){
    mu[k] ~ normal(m[k], s[k]);
  }
  // hierarchical prior
  for (k in 1:K){
    theta[k] ~ normal(mu[k], tau);
  }

  // other stuff
  beta0 ~ normal(0, 2);
  beta1 ~ normal(0, 2);

  // Likelihood
  for (i in 1:N) {
    if(sumy[i] &gt; 0) {
      // Occurred and observed
      1 ~ bernoulli(inv_logit(beta0 + beta1 * x[i] + theta[group[i]]));
      sumy[i] ~ binomial(J, p);
    } else {
      target += log_sum_exp(
        // Occurred and not observed
        bernoulli_lpmf(1 | inv_logit(beta0 + beta1 * x[i] + theta[group[i]])) + bernoulli_lpmf(0 | p) * J,
        // Not occurred
        bernoulli_lpmf(0 | inv_logit(beta0 + beta1 * x[i] + theta[group[i]]))
      );
    }
  }
}
generated quantities{
  real&lt;lower = 0, upper = 1&gt; psi[N];
  for(i in 1:N){
    psi[i] = inv_logit(beta0 + beta1 * x[i] + theta[group[i]]);
  }
} </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<pre><code>                mean       2.5%      97.5%    n_eff      Rhat
tau       1.72806107  0.6170011  4.1543961 2733.988 0.9999114
p         0.51160411  0.4864588  0.5370601 9404.881 1.0000692
beta0    -0.54986969 -2.0702491  0.8070324 2111.170 1.0002943
beta1     0.98564169  0.6681256  1.3276212 7626.307 1.0002800
theta[1] -4.97627500 -8.8543627 -2.7048151 3029.120 1.0003897
theta[2] -0.00939162 -1.3894421  1.6542390 2233.658 1.0004507
theta[3] -0.41950260 -1.8344061  1.1525231 2357.356 1.0001817
theta[4]  0.83155819 -0.6084308  2.4991407 2254.618 1.0001944
theta[5]  2.77702915  1.2413799  4.6045594 2566.216 1.0001805
theta[6]  2.64487948  1.1218330  4.2299176 2505.403 1.0004393
theta[7] -2.01339127 -4.0167960 -0.1252962 3464.901 1.0004062</code></pre>
<p><img src="index_files/figure-html5/unnamed-chunk-16-1.png" width="960" style="display: block; margin: auto;" /><img src="index_files/figure-html5/unnamed-chunk-16-2.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div class="sourceCode" id="cb7"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent"
role="doc-bibliography">
<div id="ref-daubenmire1959" class="csl-entry" role="doc-biblioentry">
Daubenmire, R.F. (1959) Canopy coverage method of vegetation analysis.
<em>Northwest Science</em>, <strong>33</strong>, 43–64.
</div>
<div id="ref-dorazio2018" class="csl-entry" role="doc-biblioentry">
Dorazio, R.M. and Erickson, R.A. (2018) <a
href="https://doi.org/10.1111/1755-0998.12735">Ednaoccupancy: An r
package for multiscale occupancy modelling of environmental DNA
data</a>. <em>Molecular Ecology Resources</em>, <strong>18</strong>,
368–380.
</div>
<div id="ref-polson2013" class="csl-entry" role="doc-biblioentry">
Polson, N.G., Scott, J.G. and Windle, J. (2013) <a
href="https://doi.org/10.1080/01621459.2013.829001">Bayesian inference
for logistic models using <span class="nocase">Pólya–gamma</span> latent
variables</a>. <em>Journal of the American Statistical Association</em>,
<strong>108</strong>, 1339–1349.
</div>
</div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
<h3 id="references">References</h3>
<div id="references-listing"></div>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
